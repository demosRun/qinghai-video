<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>{TAG_14226_TAG}</title>
    <!-- 页面的元信息 -->
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="white"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="filetype" content="1"/>
    <meta name="publishedtype" content="1"/>
    <meta name="pagetype" content="2"/>
    <meta name="full-screen" content="yes"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="browsermode" content="application"/>
    <meta name="x5-page-mode" content="app"/>
    
      <!-- 页面主样式文件 -->
      <link charset="utf-8"  rel="stylesheet" href="./static/css/owo.main.css">
      
    <!-- 附属css文件 -->
    <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">
      
    
    <link rel="stylesheet" href="./static/css/owo.animate.css">
  </head>
  <body>
    <!-- 页面区域 -->
    <!-- 页面[loading]-->
    <div class="loading-wrap owo" template="loading" style="display: none;">
    <div class="loading-text-wrap">
      <div class="image-box">
        <img class="loading-img" src="./static/resource/loading.gif">
      </div>
      <div class="progress-num">1%</div>
    </div>
    
  </div>
    <!-- 页面[one]-->
    <div class="horizontal-box owo" id="horizontal-box" template="one" style="display: none;"><div class="one"><img class="title" src="./static/resource/title.png"><img class="button" src="./static/resource/button.png" :tap="playVideo"></div><div class="video"></div><div class="show-box" :tap="showPoup"><img class="show-image" src="./static/resource/show.jpg"></div><div class="share-box" :tap="showShare"><img class="press" src="./static/resource/press.png"><img class="share" src="./static/resource/share.jpg"></div><div class="button-item-box"><img class="button-2 button-item" src="./static/resource/button-2.png" :tap="showShare"><img class="button-3 button-item" src="./static/resource/button-3.png" :tap="location.reload()"></div><img class="next" :tap="next" src="./static/resource/next.png"><div class="main-text"></div><div class="point point-1 step-1" :tap="showPoup('badge-1')"></div><div class="point point-2 step-2" :tap="showPoup('badge-2')"></div><div class="point point-3 step-3" :tap="showPoup('badge-3')"></div><div class="point point-4 step-4" :tap="showPoup('badge-1')" style="left: 46%;top: 41%;"></div><div class="point point-5 step-5" :tap="showPoup('badge-2')" style="left: 51%;top: 34%;"></div><div class="point point-6 step-6" :tap="showPoup('badge-3')" style="left: 43%;top: 77%;"></div><div class="point point-7 step-7" :tap="showPoup('badge-1')" style="left: 44%;top: 41%;"></div><div class="point point-8 step-8" :tap="showPoup('badge-2')" style="left: 36%;top: 73%;"></div><div class="point point-9 step-9" :tap="showPoup('badge-3')" style="left: 61%;top: 62%;"></div><div class="point point-10 step-10" :tap="showPoup('badge-1')" style="left: 41%;top: 41%;"></div><div class="point point-11 step-11" :tap="showPoup('badge-2')" style="left: 50%;top: 66%;"></div><div class="point point-12 step-12" :tap="showPoup('badge-3')" style="left: 60%;top: 64%;"></div><div class="point point-13 step-13" :tap="showPoup('badge-1')" style="left: 47%;top: 47%;"></div><div class="point point-14 step-14" :tap="showPoup('badge-2')" style="left: 43%;top: 64%;"></div><div class="badge-bar"><img class="badge badge-1" src="./static/resource/badge-1.png"><img class="badge badge-2" src="./static/resource/badge-2.png"><img class="badge badge-3" src="./static/resource/badge-3.png"></div></div>
    

    <script src="http://tools.people.com.cn/libs/jquery/1.11.1/jquery-1.11.1.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/lottie.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/main.js" type="text/javascript"  charset="UTF-8"></script><!-- 框架script代码 --><script>// 存储页面基本信息
var owo = {
  // 手机入口
  phoneEnter: "loading",
  // 全局方法变量
  tool: {},
  // 框架状态变量
  state: {}
};
/*
  存储每个页面的函数
  键名：页面名称
  键值：方法列表
*/

owo.script = {
  "loading": {
    "created": function created() {
      var loadingItem = owo.query('.loading-img')[0];
      var mum = owo.query('.progress-num')[0];
      var imgList = ["./static/resource/main-text.png", "./static/resource/bg.mp3", "./static/resource/bg.jpg", "./static/resource/title.png", "./static/resource/images/img_288.png"];

      for (var ind = 289; ind > 0; ind--) {
        imgList.push("./static/resource/images/img_" + ind + ".png");
      }

      this.preloadImages(imgList, function (e) {
        setTimeout(function () {
          owo.go('one', '', '', '', '', true);
        }, 0);
      }, function (num) {
        loadingItem.style.left = num + '%';
        mum.innerText = num + '%';
      });
    },
    "preloadImage": function preloadImage(src, successFn) {
      var image = new Image();

      image.onload = function () {
        successFn && successFn(src);
      };

      image.onerror = function (error) {
        successFn && successFn(src);
      };

      image.src = src;
    },
    "preloadMusic": function preloadMusic(src, successFn) {
      var music = new Audio(src);
      if (music && music.load) music.load();
      successFn && successFn(src);
    },
    "preloadImages": function preloadImages(srcs, doneFn, progressFn) {
      var _this = this;

      if (!Array.isArray(srcs)) {
        console.log('第一个参数只能是一个数组');
      } else {
        var allCount = srcs.length;
        var doneCount = 0;
        srcs.forEach(function (srcItem) {
          // 取后缀
          var fileExtension = srcItem.split('.').pop().toLowerCase(); // console.log(fileExtension)
          // 判断是否为图片
          // 判断浏览器是否支持es6

          if (![].includes) alert('浏览器版本过低，建议您使用其它浏览器浏览!');

          if (["png", "jpg", "gif", "jpeg"].includes(fileExtension)) {
            _this.preloadImage(srcItem, function () {
              doneCount++;
              progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

              if (doneCount === allCount) {
                doneFn && doneFn();
              }
            });
          } else if (["mp3"].includes(fileExtension)) {
            _this.preloadMusic(srcItem, function () {
              doneCount++;
              progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

              if (doneCount === allCount) {
                doneFn && doneFn();
              }
            });
          } else {
            doneCount++;
            progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

            if (doneCount === allCount) {
              doneFn && doneFn();
            }
          }
        });
      }
    }
  },
  "one": {
    "data": {
      "anim": null,
      "poupShow": false,
      "showButtomBar": false,
      "shareShow": false,
      "step": 1,
      "ding": null,
      "canNext": false
    },
    "created": function created() {
      // var video = document.querySelector('video');
      // enableInlineVideo(video)
      this.data.ding = new Map();
      var animData = {
        container: owo.query('.video')[0],
        renderer: 'canvas',
        loop: false,
        autoplay: false,
        setSubframe: false,
        path: './static/resource/data.json'
      };
      this.data.anim = bodymovin.loadAnimation(animData);
      this.data.anim.setSubframe(false);
      owo.tool.animate('fadeInDown', owo.query('.title')[0], 7100);
      owo.tool.animate('fadeIn', owo.query('.button')[0], 8500);
      setTimeout(function () {
        owo.query('.main-text')[0].style.width = '353px';
        setTimeout(function () {
          owo.query('.main-text')[0].style.display = 'none';
        }, 7000);
      }, 0);
    },
    "playVideo": function playVideo() {
      var _this2 = this;

      // 播放音乐
      if (!this.data.music) {
        this.data.music = new Audio("./static/resource/bg.mp3");
        this.data.music.loop = true;
        this.data.music.play();
      }

      owo.query('.one')[0].style.opacity = '0'; // 一秒后销毁one不然挡住下面不能点击

      setTimeout(function () {
        owo.query('.one')[0].style.display = 'none';
      }, 1000); // 开始播放
      // console.log(this.data.anim)

      console.log('开始播放第一段!');
      this.data.anim.playSegments([307, 560], true);
      owo.query('.show-box .show-image')[0].src = './static/resource/show-1.png';

      this.data.anim.onComplete = function (e) {
        // console.log(e)
        _this2.data.canNext = false;
        var pointList = owo.query('.step-' + _this2.data.step);

        if (pointList.length > 0) {
          owo.query('.badge-bar')[0].style.left = '8%';
          console.log('显示.step-' + _this2.data.step);
          owo.query('.step-' + _this2.data.step).forEach(function (element) {
            element.style.display = 'block';
          });
        }

        if (_this2.data.step > 14 && !_this2.data.showButtomBar) {
          _this2.data.showButtomBar = true;
          owo.query('.button-item-box')[0].style.display = 'block';
          owo.query('.button-item-box')[0].style.opacity = 1;
          return;
        }

        owo.query('.next')[0].style.display = 'block';
      };
    },
    "showPoup": function showPoup(dingClass) {
      if (dingClass) {
        this.$target.style.display = 'none';
        owo.query('.' + dingClass)[0].classList.add('active');
        this.data.canNext = true;
      }

      var showBox = owo.query('.show-box')[0];

      if (this.data.poupShow) {
        showBox.style.display = 'none';
        this.data.poupShow = false;
      } else {
        this.data.poupShow = true;
        showBox.style.display = 'block';
      }
    },
    "showShare": function showShare() {
      if (this.data.shareShow) {
        owo.query('.share-box')[0].style.display = 'none';
      } else {
        owo.query('.share-box')[0].style.display = 'block';
      }

      this.data.shareShow = !this.data.shareShow;
    },
    "clearBadge": function clearBadge(index) {
      // 清理徽章
      var badgeList = owo.query('.badge');

      for (var ind = 0; ind < badgeList.length; ind++) {
        index++;
        console.log(badgeList[ind].classList);
        badgeList[ind].classList.remove('active'); // ```
        // ./static/resource/badge-1.png
        // ./static/resource/badge-2.png
        // ./static/resource/badge-3.png
        // ./static/resource/badge-4.png
        // ./static/resource/badge-5.png
        // ./static/resource/badge-6.png
        // ./static/resource/badge-7.png
        // ./static/resource/badge-8.png
        // ./static/resource/badge-9.png
        // ./static/resource/badge-10.png
        // ./static/resource/badge-11.png
        // ./static/resource/badge-12.png
        // ./static/resource/badge-13.png
        // ./static/resource/badge-14.png
        // ```

        if (index === 15) {
          badgeList[ind].style.display = 'none';
        } else {
          badgeList[ind].src = "./static/resource/badge-" + index + ".png";
        }
      }
    },
    "next": function next() {
      if (!this.data.canNext) {
        owo.tool.toast('当前景点还没有进行打卡哦!', null, null, document.getElementById('horizontal-box'));
        return;
      }

      owo.query('.next')[0].style.display = 'none';
      var start = 307; // alert(this.data.step)

      switch (this.data.step) {
        case 1:
          this.data.step = 2;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-2.png';
          this.data.anim.playSegments([560, 660], true);
          break;

        case 2:
          this.data.step = 3;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-3.png';
          this.data.anim.playSegments([660, 760], true);
          break;

        case 3:
          this.data.step = 4;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-4.png';
          this.data.anim.playSegments([750, 867], true);
          this.clearBadge(3);
          break;

        case 4:
          this.data.step = 5;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-5.png';
          this.data.anim.playSegments([867, 730 + start], true);
          break;

        case 5:
          this.data.step = 6;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-6.png';
          this.data.anim.playSegments([730 + start, 860 + start], true);
          break;

        case 6:
          this.data.step = 7;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-7.png';
          this.data.anim.playSegments([860 + start, 960 + start], true);
          this.clearBadge(6);
          break;

        case 7:
          this.data.step = 8;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-8.png';
          this.data.anim.playSegments([960 + start, 1060 + start], true);
          break;

        case 8:
          this.data.step = 9;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-9.png';
          this.data.anim.playSegments([1060 + start, 1170 + start], true);
          break;

        case 9:
          this.data.step = 10;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-10.png';
          this.data.anim.playSegments([1170 + start, 1280 + start], true);
          this.clearBadge(9);
          break;

        case 10:
          this.data.step = 11;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-11.png';
          this.data.anim.playSegments([1280 + start, 1460 + start], true);
          break;

        case 11:
          this.data.step = 12;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-12.png';
          this.data.anim.playSegments([1460 + start, 1630 + start], true);
          break;

        case 12:
          this.data.step = 13;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-13.png';
          this.data.anim.playSegments([1630 + start, 1760 + start], true);
          this.clearBadge(12);
          break;

        case 13:
          this.data.step = 14;
          owo.query('.show-box .show-image')[0].src = './static/resource/show-14.png';
          this.data.anim.playSegments([1760 + start, 1927 + start], true);
          break;

        case 14:
          this.data.step = 15;
          this.data.anim.playSegments([1927 + start, 2500 + start], true);
          break;
      } // owo.query('.badge-' + (this.data.step - 1))[0].classList.add('active')
      // 开车隐藏徽章


      owo.query('.badge-bar')[0].style.left = '-8%';
    }
  }
};</script>
<!-- 框架script文件 -->
<script src="./static/js/owo.main.js" type="text/javascript" charset="UTF-8"></script>
  </body>
</html>