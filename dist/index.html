<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>{TAG_14226_TAG}</title>
    <!-- 页面的元信息 -->
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="white"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="filetype" content="1"/>
    <meta name="publishedtype" content="1"/>
    <meta name="pagetype" content="2"/>
    <meta name="full-screen" content="yes"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="browsermode" content="application"/>
    <meta name="x5-page-mode" content="app"/>
    
      <!-- 页面主样式文件 -->
      <link charset="utf-8"  rel="stylesheet" href="./static/css/owo.main.css">
      
    <!-- 附属css文件 -->
    <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">
      
    
    
  </head>
  <body>
    <!-- 页面区域 -->
    <!-- 页面[loading]-->
    <div class="loading-wrap owo" template="loading" style="display: none;">
    <div class="loading-text-wrap">
      <div class="image-box">
        <img class="loading-img" src="./static/resource/loading.gif">
      </div>
      <div class="progress-num">1%</div>
    </div>
    
  </div>
    <!-- 页面[one]-->
    <div class="horizontal-box owo" id="horizontal-box" template="one" style="display: none;"><div class="one"><img class="title" src="./static/resource/title.png"><img class="button" src="./static/resource/button.png" :tap="playVideo"></div><div class="video" :tap="showPoup"></div><img class="show-box" :tap="showPoup"><div class="share-box" :tap="showShare"><img class="press" src="./static/resource/press.png"><img class="share" src="./static/resource/share.jpg"></div><div class="button-item-box"><img class="button-2 button-item" src="./static/resource/button-2.png" :tap="showShare"><img class="button-3 button-item" src="./static/resource/button-3.png" :tap="location.reload()"></div></div>
    

    <script src="http://tools.people.com.cn/libs/jquery/1.11.1/jquery-1.11.1.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/iphone-inline-video.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/lottie.min.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/main.js" type="text/javascript"  charset="UTF-8"></script><!-- 框架script代码 --><script>// 存储页面基本信息
var owo = {
  // 手机入口
  phoneEnter: "loading",
  // 全局方法变量
  tool: {},
  // 框架状态变量
  state: {}
};
/*
  存储每个页面的函数
  键名：页面名称
  键值：方法列表
*/

owo.script = {
  "loading": {
    "created": function created() {
      var loadingItem = owo.query('.loading-img')[0];
      var mum = owo.query('.progress-num')[0];
      var imgList = ["./static/resource/bg.mp3", "./static/resource/bg.jpg", "./static/resource/popup-1.png", "./static/resource/popup-2.png", "./static/resource/popup-3.png", "./static/resource/popup-4.png", "./static/resource/popup-5.png", "./static/resource/popup-6.png", "./static/resource/title.png"];

      for (var ind = 0; ind < 68; ind++) {
        imgList.push("./static/resource/images/img_" + ind + ".png");
      }

      this.preloadImages(imgList, function (e) {
        setTimeout(function () {
          owo.go('one', '', '', '', '', true);
        }, 800);
      }, function (num) {
        loadingItem.style.left = num + '%';
        mum.innerText = num + '%';
      });
    },
    "preloadImage": function preloadImage(src, successFn) {
      setTimeout(function () {
        var image = new Image();
        image.src = src;

        image.onload = function () {
          successFn && successFn(src);
        };

        image.onerror = function (error) {
          successFn && successFn(src);
        };
      }, 0);
    },
    "preloadMusic": function preloadMusic(src, successFn) {
      var music = new Audio(src);
      if (music && music.load) music.load();
      successFn && successFn(src);
    },
    "preloadImages": function preloadImages(srcs, doneFn, progressFn) {
      var _this = this;

      if (!Array.isArray(srcs)) {
        console.log('第一个参数只能是一个数组');
      } else {
        var allCount = srcs.length;
        var doneCount = 0;
        srcs.forEach(function (srcItem) {
          // 取后缀
          var fileExtension = srcItem.split('.').pop().toLowerCase();
          console.log(fileExtension); // 判断是否为图片
          // 判断浏览器是否支持es6

          if (![].includes) alert('浏览器版本过低，建议您使用其它浏览器浏览!');

          if (["png", "jpg", "gif", "jpeg"].includes(fileExtension)) {
            _this.preloadImage(srcItem, function () {
              doneCount++;
              progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

              if (doneCount === allCount) {
                doneFn && doneFn();
              }
            });
          } else if (["mp3"].includes(fileExtension)) {
            _this.preloadMusic(srcItem, function () {
              doneCount++;
              progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

              if (doneCount === allCount) {
                doneFn && doneFn();
              }
            });
          } else {
            doneCount++;
            progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

            if (doneCount === allCount) {
              doneFn && doneFn();
            }
          }
        });
      }
    }
  },
  "one": {
    "data": {
      "anim": null,
      "poupShow": false,
      "showButtomBar": false,
      "shareShow": false
    },
    "created": function created() {// var video = document.querySelector('video');
      // enableInlineVideo(video)
    },
    "playVideo": function playVideo() {
      var _this2 = this;

      // 播放音乐
      if (!this.data.music) {
        this.data.music = new Audio("./static/resource/bg.mp3");
        this.data.music.loop = true;
        this.data.music.play();
      }

      owo.query('.one')[0].style.opacity = '0'; // 一秒后销毁one不然挡住下面不能点击

      setTimeout(function () {
        owo.query('.one')[0].style.display = 'none';
      }, 1000);
      var animData = {
        wrapper: owo.query('.video')[0],
        renderer: "canvas",
        loop: false,
        prerender: false,
        autoplay: true,
        path: './static/resource/data.json'
      };
      this.data.anim = bodymovin.loadAnimation(animData); // const video = owo.query('video')[0]
      // setTimeout(() => {
      //   video.style.opacity = '1'
      //   video.play()
      //   owo.query('.one')[0].style.display = 'none'
      // }, 500)

      this.data.anim.onEnterFrame = function (e) {
        if (e.currentTime > 1110 && !_this2.data.showButtomBar) {
          _this2.data.showButtomBar = true;
          owo.query('.button-item-box')[0].style.display = 'block';
          owo.query('.button-item-box')[0].style.opacity = 1;
        }
      };
    },
    "showPoup": function showPoup() {
      var imageSrc = null;
      var time = this.data.anim.currentFrame;

      if (time > 150 && time < 250) {
        imageSrc = './static/resource/popup-1.png';
      }

      if (time > 300 && time < 400) {
        imageSrc = './static/resource/popup-2.png';
      }

      if (time > 500 && time < 580) {
        imageSrc = './static/resource/popup-3.png';
      }

      if (time > 660 && time < 750) {
        imageSrc = './static/resource/popup-4.png';
      }

      if (time > 830 && time < 930) {
        imageSrc = './static/resource/popup-5.png';
      }

      if (time > 1100) {
        imageSrc = './static/resource/popup-6.png';
      }

      if (!imageSrc) {
        return;
      }

      var showBox = owo.query('.show-box')[0];
      showBox.src = imageSrc;

      if (this.data.poupShow) {
        if (time < 1100) this.data.anim.play();
        showBox.style.display = 'none';
        this.data.poupShow = false;
      } else {
        this.data.poupShow = true;
        this.data.anim.pause();
        showBox.style.display = 'block';
      }
    },
    "showShare": function showShare() {
      if (this.data.shareShow) {
        owo.query('.share-box')[0].style.display = 'none';
      } else {
        owo.query('.share-box')[0].style.display = 'block';
      }

      this.data.shareShow = !this.data.shareShow;
    }
  }
};</script>
<!-- 框架script文件 -->
<script src="./static/js/owo.main.js" type="text/javascript" charset="UTF-8"></script>
  </body>
</html>